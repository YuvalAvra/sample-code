{
  "_id": "containerRuntime",
  "rules": [
    {
      "modified": "2020-06-17T17:11:30.861Z",
      "owner": "admin",
      "name": "Protect notemaker apps from suspicious runtime activities",
      "previousName": "",
      "notes": "Specialized for notemaker applications",
      "collections": [
        { 
          "hosts": [
            "*"
          ],
          "images": [
            "*"
          ],
          "labels": [
            "*"
          ],
          "containers": [
            "*"
          ],
          "namespaces": [
            "notemaker"
          ],
          "accountIDs": [
            "*"
          ],
          "clusters": [
            "*"
          ],
          "name": "notemaker",
          "owner": "mbarker_paloaltonetworks_com",
          "modified": "2021-02-05T16:57:18.812Z",
          "color": "#554a65",
          "description": "Notemaker protection",
          "system": false
        }
      ],
      "advancedProtection": true,
      "processes": {
        "effect": "prevent",
        "blacklist": [],
        "whitelist": [
          "/bin/dash",
          "/tmp/remote.sh",
          "/usr/bin/test",
          "/bin/tar",
          "/usr/bin/wget",
          "/usr/bin/curl"
        ],
        "checkCryptoMiners": true,
        "checkLateralMovement": true
      },
      "network": {
        "effect": "alert",
        "blacklistIPs": [],
        "blacklistListeningPorts": [],
        "whitelistListeningPorts": [],
        "blacklistOutboundPorts": [],
        "whitelistOutboundPorts": [],
        "whitelistIPs": [],
        "skipModifiedProc": false,
        "detectPortScan": true,
        "skipRawSockets": false
      },
      "dns": {
        "effect": "prevent",
        "whitelist": [
          "*.notemaker.svc.cluster.local",
          "*.paloaltonetworks.com"
        ],
        "blacklist": [
          "*"
        ]
      },
      "filesystem": {
        "effect": "prevent",
        "blacklist": [],
        "whitelist": [
          "/tmp"
        ],
        "checkNewFiles": true,
        "backdoorFiles": true
      },
      "kubernetesEnforcement": false,
      "cloudMetadataEnforcement": false
    },
    {
      "modified": "2020-06-17T17:11:25.168Z",
      "owner": "admin",
      "name": "Block suspicious activities in Notemaker App",
      "previousName": "",
      "notes": "block one at a time",
      "collections": [
        {
          "hosts": [
            "*"
          ],
          "images": [
            "*"
          ],
          "labels": [
            "*"
          ],
          "containers": [
            "*"
          ],
          "namespaces": [
            "notemaker"
          ],
          "accountIDs": [
            "*"
          ],
          "clusters": [
            "*"
          ],
          "name": "notemaker",
          "owner": "mbarker_paloaltonetworks_com",
          "modified": "2021-02-05T16:57:18.812Z",
          "color": "#554a65",
          "description": "Notemaker protection",
          "system": false
        }
      ],
      "advancedProtection": true,
      "processes": {
        "effect": "block",
        "blacklist": [],
        "whitelist": [
          "/tmp/remote.sh"
        ],
        "checkCryptoMiners": true,
        "checkLateralMovement": true
      },
      "network": {
        "effect": "block",
        "blacklistIPs": [],
        "blacklistListeningPorts": [],
        "whitelistListeningPorts": [],
        "blacklistOutboundPorts": [],
        "whitelistOutboundPorts": [],
        "whitelistIPs": [],
        "skipModifiedProc": false,
        "detectPortScan": true,
        "skipRawSockets": false
      },
      "dns": {
        "effect": "block",
        "whitelist": [],
        "blacklist": []
      },
      "filesystem": {
        "effect": "block",
        "blacklist": [],
        "whitelist": [
          "/tmp"
        ],
        "checkNewFiles": true,
        "backdoorFiles": true
      },
      "kubernetesEnforcement": false,
      "cloudMetadataEnforcement": false
    },
    {
      "modified": "2020-10-15T20:23:37.878Z",
      "owner": "mbarker_paloaltonetworks_com",
      "name": "Protect struts server from suspicious runtime activities",
      "previousName": "",
      "collections": [
        {
          "hosts": [
            "*"
          ],
          "images": [
            "tl_demo/struts2_demo:2.3.12_build",
            "tl_demo/struts2_demo*"
          ],
          "labels": [
            "*"
          ],
          "containers": [
            "*"
          ],
          "namespaces": [
            "*"
          ],
          "accountIDs": [
            "*"
          ],
          "clusters": [
            "*"
          ],
          "name": "AppEmbeddedStruts",
        }
      ],
      "advancedProtection": true,
      "processes": {
        "effect": "alert",
        "blacklist": [],
        "whitelist": [],
        "checkCryptoMiners": true,
        "checkLateralMovement": true
      },
      "network": {
        "effect": "alert",
        "blacklistIPs": [],
        "blacklistListeningPorts": [],
        "whitelistListeningPorts": [],
        "blacklistOutboundPorts": [],
        "whitelistOutboundPorts": [],
        "whitelistIPs": [],
        "skipModifiedProc": false,
        "detectPortScan": true,
        "skipRawSockets": false
      },
      "dns": {
        "effect": "block",
        "whitelist": [],
        "blacklist": []
      },
      "filesystem": {
        "effect": "alert",
        "blacklist": [],
        "whitelist": [],
        "checkNewFiles": true,
        "backdoorFiles": true
      },
      "kubernetesEnforcement": false,
      "cloudMetadataEnforcement": false
    },
    {
      "modified": "2020-10-20T14:01:58.192Z",
      "owner": "operator",
      "name": "demo_build - ignore infrastructure",
      "previousName": "",
      "notes": "demo_build use only",
      "resources": {
        "hosts": [
          "*"
        ],
        "images": [
          "*gogs*",
          "*jenkins*",
          "*maildev*",
          "*nexus3*",
          "*openldap*",
          "*postgres*",
          "*selenium*",
          "*splunk*",
          "*twistlock/defender*",
          "*twistlock/console*"
        ],
        "labels": [
          "*"
        ],
        "containers": [
          "*"
        ],
        "namespaces": [
          "*"
        ],
        "accountIDs": [
          "*"
        ]
      },
      "advancedProtection": false,
      "processes": {
        "effect": "disable",
        "blacklist": [],
        "whitelist": [],
        "skipModified": true
      },
      "network": {
        "effect": "disable",
        "blacklistIPs": [],
        "blacklistListeningPorts": [],
        "whitelistListeningPorts": [],
        "blacklistOutboundPorts": [],
        "whitelistOutboundPorts": [],
        "whitelistIPs": [],
        "skipModifiedProc": true,
        "detectPortScan": false,
        "skipRawSockets": false
      },
      "dns": {
        "effect": "disable",
        "whitelist": [],
        "blacklist": []
      },
      "filesystem": {
        "effect": "disable",
        "blacklist": [],
        "whitelist": [],
        "checkNewFiles": false,
        "backdoorFiles": false
      },
      "kubernetesEnforcement": false,
      "cloudMetadataEnforcement": false
    },
    {
      "modified": "2020-10-20T14:01:30.231Z",
      "owner": "operator",
      "name": "Default- alert on suspicious runtime behavior",
      "previousName": "",
      "notes": "Customized for demo build - alert on any suspicious activity or any attack",
      "resources": {
        "hosts": [
          "*"
        ],
        "images": [
          "*"
        ],
        "labels": [
          "*"
        ],
        "containers": [
          "*"
        ],
        "namespaces": [
          "*"
        ],
        "accountIDs": [
          "*"
        ]
      },
      "advancedProtection": true,
      "processes": {
        "effect": "alert",
        "blacklist": [],
        "whitelist": [],
        "checkCryptoMiners": true,
        "checkLateralMovement": true,
        "checkParentChild": true
      },
      "network": {
        "effect": "alert",
        "blacklistIPs": [],
        "blacklistListeningPorts": [],
        "whitelistListeningPorts": [],
        "blacklistOutboundPorts": [],
        "whitelistOutboundPorts": [],
        "whitelistIPs": [],
        "skipModifiedProc": false,
        "detectPortScan": true,
        "skipRawSockets": false
      },
      "dns": {
        "effect": "alert",
        "whitelist": [],
        "blacklist": []
      },
      "filesystem": {
        "effect": "alert",
        "blacklist": [],
        "whitelist": [],
        "checkNewFiles": true,
        "backdoorFiles": true
      },
      "kubernetesEnforcement": true,
      "cloudMetadataEnforcement": true,
      "customRules": [
        {
          "_id": 26,
          "action": "audit",
          "effect": "alert"
        },
        {
          "_id": 19,
          "action": "audit",
          "effect": "alert"
        },
        {
          "_id": 23,
          "action": "audit",
          "effect": "alert"
        }
      ]
    }
  ],
  "learningDisabled": false
}
